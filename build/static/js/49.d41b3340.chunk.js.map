{"version":3,"file":"static/js/49.d41b3340.chunk.js","mappings":"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","sources":["pages/Orders/_components/Modal.tsx","pages/Orders/Orders.tsx"],"sourcesContent":["import { useProductAddMutation, useProductUpdateMutation } from \"store/endpoints\";\r\nimport { Form, message, Input, InputNumber, Upload, Select, ModalProps, Modal } from \"antd\";\r\nimport { LoadingOutlined, PlusOutlined } from '@ant-design/icons';\r\nimport type { UploadChangeParam } from 'antd/es/upload';\r\nimport { useDispatch } from 'react-redux';\r\nimport type { RcFile, UploadFile, UploadProps } from 'antd/es/upload/interface';\r\nimport React, { useState, useEffect } from 'react';\r\nimport { updateProductStates } from \"../../../store/slices/productSlice\";\r\n\r\nconst { TextArea } = Input\r\nconst { Option } = Select;\r\n\r\ntype Props = ModalProps & {\r\n    categoryData: any,\r\n    updateData: any,\r\n    modalType: string;\r\n    t: any\r\n};\r\n\r\nconst formItemLayout = {\r\n    labelCol: {\r\n        span: 8,\r\n    },\r\n    wrapperCol: {\r\n        span: 14,\r\n    },\r\n}\r\n\r\nconst getBase64 = (img: RcFile, callback: (url: string) => void) => {\r\n    const reader = new FileReader();\r\n    reader.addEventListener('load', () => callback(reader.result as string));\r\n    reader.readAsDataURL(img);\r\n};\r\n\r\nconst beforeUpload = (file: RcFile) => {\r\n    const isJpgOrPng = file.type === 'image/jpeg' || file.type === 'image/png';\r\n    if (!isJpgOrPng) {\r\n        message.error('Siz faqat JPG/PNG turdagi fayllarni yuklay olasiz!');\r\n    }\r\n    const isLt2M = file.size / 1024 / 1024 < 2;\r\n    if (!isLt2M) {\r\n        message.error(\"Surat hajmi 2MB dan kichik bo'lishi kerak!\");\r\n    }\r\n    return isJpgOrPng && isLt2M;\r\n};\r\n\r\nconst OrdersModal: React.FC<Props> = ({ updateData, t, categoryData, modalType, ...modalProps }) => {\r\n    const dispatch = useDispatch()\r\n    const [loading, setLoading] = useState(false);\r\n    const [imageUrl, setImageUrl] = useState<string>();\r\n    const [responseImageUrl, setResponseImageUrl] = useState<string>();\r\n    const [form] = Form.useForm();\r\n    const [productUpdateMutation, productUpdate] = useProductUpdateMutation();\r\n    const [productMutation, productCreate] = useProductAddMutation();\r\n    const clearState = () => {\r\n        setImageUrl('')\r\n        form.resetFields()\r\n    }\r\n    useEffect(() => {\r\n        if (updateData && modalType === 'update') {\r\n            setImageUrl(`http://147.182.130.242:3000/${updateData?.image}`)\r\n            form.setFieldsValue({\r\n                image: updateData?.image,\r\n                name: updateData?.name,\r\n                categoryId: updateData?.categoryId,\r\n                description: updateData?.description,\r\n                price: updateData?.price,\r\n                discount: updateData?.discount\r\n            })\r\n        }\r\n        return () => clearState()\r\n        // eslint-disable-next-line react-hooks/exhaustive-deps\r\n    }, [updateData, modalType])\r\n\r\n    const handleSubmit = () => {\r\n        form.validateFields()\r\n            .then(data => {\r\n                console.log('data: ', data);\r\n                const formData = { ...data, image: responseImageUrl }\r\n                if (modalType === 'update') {\r\n                    data.image = responseImageUrl\r\n                    const productPromise = productUpdateMutation({\r\n                        id: updateData.id,\r\n                        value: formData,\r\n                    }).unwrap();\r\n                    productPromise\r\n                        .then((res: { statusCode: number; }) => {\r\n                            if (res.statusCode === 200) {\r\n                                message.success(\"Muvaffaqiyati tahrirlandi.\");\r\n                                dispatch(updateProductStates({ openModal: false, modalType: '' }))\r\n                                setImageUrl(\"\")\r\n                                form.resetFields();\r\n                            }\r\n                        })\r\n                        .catch((err: { message: any; }) => {\r\n                            message.error(`Xatolik yuz berdi. Xatolik: ${err.message}`);\r\n                        });\r\n                } else if (modalType === 'create') {\r\n                    const productPromise = productMutation(formData).unwrap();\r\n                    productPromise\r\n                        .then((res) => {\r\n                            if (res.statusCode === 200) {\r\n                                message.success(\"Muvaffaqiyati saqlandi.\");\r\n                                dispatch(updateProductStates({ openModal: false, modalType: '' }))\r\n                                clearState()\r\n                            }\r\n                        })\r\n                        .catch((err) => {\r\n                            message.error(`Xatolik yuz berdi. Xatolik: ${err.message}`);\r\n                        });\r\n                }\r\n            }).catch(err => console.log('Form error: ', err))\r\n\r\n    };\r\n\r\n    const handleChange: UploadProps['onChange'] = (info: UploadChangeParam<UploadFile>) => {\r\n        if (info.file.status === 'uploading') {\r\n            setLoading(true);\r\n            return;\r\n        }\r\n        if (info.file.status === 'done') {\r\n            setResponseImageUrl(info.file.response.result.url)\r\n            // Get this url from response in real world.\r\n            getBase64(info.file.originFileObj as RcFile, url => {\r\n                setLoading(false);\r\n                setImageUrl(url);\r\n            });\r\n        }\r\n    };\r\n\r\n    const uploadButton = (\r\n        <div>\r\n            {loading ? <LoadingOutlined /> : <PlusOutlined />}\r\n            <div style={{ marginTop: 8 }}>Upload</div>\r\n        </div>\r\n    );\r\n    const categoryOptions = categoryData?.map((category: { id: any; name: string | number | boolean | React.ReactElement<any, string | React.JSXElementConstructor<any>> | React.ReactFragment | React.ReactPortal | null | undefined; }) => (<Option key={category.id} value={category.id}>{category.name}</Option>))\r\n    const props = { onOk: handleSubmit, confirmLoading: modalType.length ? modalType === 'create' ? productCreate.isLoading : productUpdate.isLoading : false, forceRender: true, ...modalProps }\r\n    return (\r\n        <>\r\n            <Modal\r\n                {...props}\r\n            >\r\n                <Form\r\n                    {...formItemLayout}\r\n                    form={form}\r\n                    name=\"basic\"\r\n                    layout=\"horizontal\"\r\n                    autoComplete=\"off\"\r\n                >\r\n                    <Form.Item\r\n                        name='image'\r\n                        label={t(\"image\")}\r\n                        rules={[\r\n                            { required: true, message: `Rasm yuklanmadi` },\r\n                        ]}\r\n                    >\r\n                        <Upload\r\n                            name=\"file\"\r\n                            listType=\"picture-card\"\r\n                            className=\"avatar-uploader\"\r\n                            showUploadList={false}\r\n                            action=\"http://147.182.130.242:3000/image-upload\"\r\n                            beforeUpload={beforeUpload}\r\n                            onChange={handleChange}\r\n                            maxCount={1}\r\n                        >\r\n                            {imageUrl ? <img src={imageUrl} alt=\"productImage\" style={{ width: '100%' }} /> : uploadButton}\r\n                        </Upload>\r\n                    </Form.Item>\r\n                    <Form.Item\r\n                        name=\"name\"\r\n                        label={t(\"productsMenu.productName\")}\r\n                        rules={[\r\n                            { required: true, message: `Mahsulot nomini kiriting` },\r\n                        ]}\r\n                    >\r\n                        <Input placeholder=\"Nomini kiriting\" />\r\n                    </Form.Item>\r\n                    <Form.Item\r\n                        name=\"categoryId\"\r\n                        label={t(\"productsMenu.category\")}\r\n                        rules={[\r\n                            { required: true, message: `Kategoriyalar` },\r\n                        ]}\r\n                    >\r\n                        <Select allowClear placeholder='Kategoriyani tanlang'>\r\n                            {categoryOptions}\r\n                        </Select>\r\n                    </Form.Item>\r\n                    <Form.Item\r\n                        name=\"description\"\r\n                        label={t(\"productsMenu.description\")}\r\n                        rules={[\r\n                            { required: true, message: `Ta'rif kiriting` },\r\n                        ]}\r\n                    >\r\n                        <TextArea allowClear autoSize placeholder=\"Ta'rifni kiriting\" />\r\n                    </Form.Item>\r\n                    <Form.Item\r\n                        name=\"price\"\r\n                        label={t(\"productsMenu.price\")}\r\n                        style={{ width: '100%' }}\r\n                        rules={[\r\n                            { required: true, message: `Narxni kiriting` },\r\n                        ]}\r\n                    >\r\n                        <InputNumber addonAfter=\"so'm\" placeholder=\"1000\" style={{ width: '100%' }} />\r\n                    </Form.Item>\r\n                    <Form.Item\r\n                        name=\"discount\"\r\n                        label={t(\"productsMenu.discount\")}\r\n                        rules={[\r\n                            { required: false, message: `Chegirma kiriting` },\r\n                        ]}\r\n                    >\r\n                        <InputNumber addonAfter=\"%\" placeholder=\"5\" style={{ width: '100%' }} />\r\n                    </Form.Item>\r\n                </Form>\r\n            </Modal>\r\n        </>\r\n    );\r\n};\r\n\r\nexport default OrdersModal;\r\n","import React, { useState } from \"react\";\r\nimport type { RootState } from '../../store/store'\r\nimport { Button, Col, message, Row, Image, Space, Typography, Table, Popconfirm } from \"antd\";\r\nimport type { ColumnsType } from 'antd/es/table';\r\nimport { useTranslation } from 'react-i18next';\r\nimport OrdersModal from \"./_components/Modal\";\r\nimport { ProductDTO } from \"types\";\r\nimport { useOrderDeleteMutation, useOrderQuery, useCategoryListQuery } from \"store/endpoints\";\r\nimport { useSelector, useDispatch } from 'react-redux';\r\nimport { updateProductStates } from \"../../store/slices/productSlice\";\r\n\r\nconst Orders: React.FC = () => {\r\n    const { t } = useTranslation()\r\n    const { openModal, modalType } = useSelector((state: RootState) => state.productSlice)\r\n    const dispatch = useDispatch()\r\n    const [query, setQuery] = useState({ page: 1, pageSize: 20 })\r\n\r\n    const categoryQuery = useCategoryListQuery();\r\n    const orderQuery = useOrderQuery(query);\r\n    const [orderDelete, { isLoading }] = useOrderDeleteMutation();\r\n    const [updateData, setUpdateData] = useState();\r\n    const handleUpdate = (data: any) => {\r\n        setUpdateData(data);\r\n        dispatch(updateProductStates({ openModal: true, modalType: 'update' }))\r\n    };\r\n    const handleDelete = (id: number | undefined) => {\r\n        const category = orderDelete({ id }).unwrap();\r\n        category\r\n            .then((res) => {\r\n                if (res.statusCode === 200) {\r\n                    message.success(\"Muvaffaqiyati o'chirildi.\");\r\n                }\r\n            })\r\n            .catch((err) => {\r\n                message.error(`Xatolik yuz berdi. Xatolik: ${err.message}`);\r\n            });\r\n    };\r\n\r\n    const columns: ColumnsType<any> = [\r\n        {\r\n            title: \"№\",\r\n            dataIndex: \"id\",\r\n            key: \"id\",\r\n            width: \"5%\",\r\n            render: (item, record, index) => <span>{index + 1}</span>,\r\n        },\r\n        {\r\n            title: t(\"productsMenu.name\"),\r\n            dataIndex: \"name\",\r\n            key: \"name\",\r\n            // width: \"75%\",\r\n            render: (item, record: any) => {\r\n                return <Space size={5}>\r\n                    <Image\r\n                        width={30}\r\n                        height={30}\r\n                        src={`http://147.182.130.242:3000/${record.image}`}\r\n                        fallback=\"data:image/png;base64,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\"\r\n                    />{item}</Space>\r\n            }\r\n        },\r\n        {\r\n            title: t(\"productsMenu.description\"),\r\n            dataIndex: \"description\",\r\n            key: \"description\",\r\n            // width: \"75%\",\r\n            render: (item, record) => <>{item}</>\r\n        },\r\n        {\r\n            title: t(\"productsMenu.price\"),\r\n            dataIndex: \"price\",\r\n            key: \"price\",\r\n            // width: \"75%\",\r\n            render: (item, record) => <>{item}</>\r\n        },\r\n        {\r\n            title: t(\"productsMenu.discount\"),\r\n            dataIndex: \"discount\",\r\n            key: \"discount\",\r\n            // width: \"75%\",\r\n            render: (item, record) => <>{item}</>\r\n        },\r\n        {\r\n            title: t(\"actions\"),\r\n            key: \"action\",\r\n            width: \"20%\",\r\n            render: (item: ProductDTO, record, index) => {\r\n                return (\r\n                    <Row wrap={false} gutter={5}>\r\n                        <Col>\r\n                            <Button\r\n                                size=\"small\"\r\n                                type=\"primary\"\r\n                                ghost\r\n                                onClick={() => handleUpdate(item)}\r\n                            >\r\n                                {t('edit')}\r\n                            </Button>\r\n                        </Col>\r\n                        <Col>\r\n                            <Popconfirm\r\n                                okText={t(\"yes\")}\r\n                                cancelText={t(\"no\")}\r\n                                onConfirm={() => handleDelete(item.id)}\r\n                                title={t(\"sureDelete\")}\r\n                            >\r\n                                <Button size=\"small\" danger disabled={isLoading}>\r\n                                    {t(\"delete\")}\r\n                                </Button>\r\n                            </Popconfirm>\r\n                        </Col>\r\n                    </Row>\r\n                );\r\n            },\r\n        },\r\n    ];\r\n    const handleCloseModal = () => {\r\n        dispatch(updateProductStates({ openModal: false, modalType: '' }))\r\n        setUpdateData(undefined)\r\n    }\r\n\r\n    const pagination =\r\n    {\r\n        total: orderQuery.data?.meta?.total * orderQuery.data?.meta?.pagesize,\r\n        page: query.page,\r\n        pageSizeOptions: [\"20\", \"50\", \"100\"],\r\n        showQuickJumper: true, showSizeChanger: true,\r\n        pageSize: query.pageSize,\r\n        current: query.page,\r\n        onChange: (page: number, pageSize: number) => {\r\n            setQuery({ page: page, pageSize: pageSize })\r\n        }\r\n    }\r\n\r\n    const modalProps = {\r\n        title: modalType === 'update' ? t('edit') : t('add'),\r\n        open: openModal,\r\n        okText: modalType === 'update' ? t('edit') : t('add'),\r\n        cancelText: t('close'),\r\n        onCancel: handleCloseModal\r\n    }\r\n\r\n    return (\r\n        <>\r\n            <Row>\r\n                <Col span={20}>\r\n                    <Typography.Title level={2}>{t('menus.orders')}</Typography.Title>\r\n                </Col>\r\n                <Col span={4}>\r\n                    <Button\r\n                        type=\"primary\"\r\n                        onClick={() => dispatch(updateProductStates({ openModal: true, modalType: 'create' }))}\r\n                    >\r\n                        {t('add')}\r\n                    </Button>\r\n                </Col>\r\n            </Row>\r\n\r\n            <Table\r\n                columns={columns}\r\n                dataSource={orderQuery.data?.data}\r\n                loading={orderQuery.isFetching}\r\n                rowKey={record => record.id}\r\n                pagination={pagination}\r\n            />\r\n            <OrdersModal updateData={updateData} t={t} modalType={modalType} categoryData={categoryQuery.data?.data} {...modalProps} />\r\n        </>\r\n    );\r\n};\r\n\r\nexport default Orders;\r\n"],"names":["TextArea","Input","Option","Select","formItemLayout","labelCol","span","wrapperCol","beforeUpload","file","isJpgOrPng","type","message","isLt2M","size","updateData","t","categoryData","modalType","modalProps","dispatch","useDispatch","useState","loading","setLoading","imageUrl","setImageUrl","responseImageUrl","setResponseImageUrl","Form","form","useProductUpdateMutation","productUpdateMutation","productUpdate","useProductAddMutation","productMutation","productCreate","clearState","resetFields","useEffect","image","setFieldsValue","name","categoryId","description","price","discount","uploadButton","LoadingOutlined","PlusOutlined","style","marginTop","categoryOptions","map","category","value","id","props","onOk","validateFields","then","data","console","log","formData","unwrap","res","statusCode","updateProductStates","openModal","catch","err","confirmLoading","length","isLoading","forceRender","layout","autoComplete","label","rules","required","listType","className","showUploadList","action","onChange","info","status","response","result","url","img","callback","reader","FileReader","addEventListener","readAsDataURL","getBase64","originFileObj","maxCount","src","alt","width","placeholder","allowClear","autoSize","addonAfter","useTranslation","useSelector","state","productSlice","page","pageSize","query","setQuery","categoryQuery","useCategoryListQuery","orderQuery","useOrderQuery","useOrderDeleteMutation","orderDelete","setUpdateData","columns","title","dataIndex","key","render","item","record","index","height","fallback","wrap","gutter","ghost","onClick","okText","cancelText","onConfirm","danger","disabled","pagination","total","meta","pagesize","pageSizeOptions","showQuickJumper","showSizeChanger","current","open","onCancel","undefined","level","dataSource","isFetching","rowKey"],"sourceRoot":""}