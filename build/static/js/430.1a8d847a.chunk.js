"use strict";(self.webpackChunkdelivery_admin=self.webpackChunkdelivery_admin||[]).push([[430],{7430:function(e,n,a){a.r(n),a.d(n,{default:function(){return P}});var r=a(1413),i=a(9439),t=a(2791),o=a(3695),l=a(6106),d=a(914),s=a(7309),u=a(1520),c=a(5485),p=a(1756),h=a(3168),m=a(4925),g=a(2972),f=a(3734),Z=a(1095),x=a(2862),y=a(9389),v=a(3344),j=a(1666),k=a(5010),b=a(2426),w=a.n(b),M=[{id:2,name:"ADMIN"},{id:3,name:"COURIER"}],C=function(e){return e&&e>=w()().endOf("day")},T="DD.MM.YYYY",F=a(1490),I=a(184),z=["updateData","t","modalType"],S=f.Z.Option,D={labelCol:{span:8},wrapperCol:{span:14}},q=function(e){var n=e.updateData,a=e.t,l=e.modalType,d=(0,m.Z)(e,z),s=(0,k.I0)(),u=Z.Z.useForm(),c=(0,i.Z)(u,1)[0],p=(0,g.rZ)(),h=(0,i.Z)(p,2),b=h[0],q=h[1],P=(0,g.Z)(),R=(0,i.Z)(P,2),X=R[0],Y=R[1];(0,t.useEffect)((function(){if(n&&"update"===l){var e=new Date(n.birthday);c.setFieldsValue({username:null===n||void 0===n?void 0:n.username,password:n.password,phone:null===n||void 0===n?void 0:n.phone,role:null===n||void 0===n?void 0:n.role,price:null===n||void 0===n?void 0:n.price,birthday:w()("".concat(e.getDate(),".").concat(e.getMonth()+1,".").concat(e.getFullYear()),T)})}return function(){c.resetFields()}}),[n,l]);var O=M.map((function(e){return(0,I.jsx)(S,{value:e.name,children:e.name},e.id)})),L=(0,r.Z)({onOk:function(){c.validateFields().then((function(e){var a=(0,r.Z)((0,r.Z)({},e),{},{phone:e.phone.toString()});if(console.log("formData: ",a),"update"===l)b({id:n.id,value:a}).unwrap().then((function(e){200===e.statusCode&&(o.ZP.success("Muvaffaqiyati tahrirlandi."),s((0,F.de)({openModal:!1,modalType:""})),c.resetFields())})).catch((function(e){o.ZP.error("Xatolik yuz berdi. Xatolik: ".concat(e.message))}));else if("create"===l){X(a).unwrap().then((function(e){200===e.statusCode&&(o.ZP.success("Muvaffaqiyati saqlandi."),s((0,F.de)({openModal:!1,modalType:""})),c.resetFields())})).catch((function(e){o.ZP.error("Xatolik yuz berdi. Xatolik: ".concat(e.message))}))}})).catch((function(e){return console.log("Form error: ",e)}))},confirmLoading:!!l.length&&("create"===l?Y.isLoading:q.isLoading),forceRender:!0},d);return(0,I.jsx)(I.Fragment,{children:(0,I.jsx)(x.Z,(0,r.Z)((0,r.Z)({},L),{},{children:(0,I.jsxs)(Z.Z,(0,r.Z)((0,r.Z)({},D),{},{form:c,name:"basic",layout:"horizontal",autoComplete:"off",children:[(0,I.jsx)(Z.Z.Item,{name:"username",label:a("usersMenu.username"),rules:[{required:!0,message:"Username kiriting"}],children:(0,I.jsx)(y.Z,{placeholder:"Username kiriting"})}),(0,I.jsx)(Z.Z.Item,{name:"password",label:"Parol:",rules:[{required:"create"===l,message:"Parol kiriting"}],children:(0,I.jsx)(y.Z,{placeholder:"Parol kiriting"})}),(0,I.jsx)(Z.Z.Item,{name:"phone",label:a("usersMenu.phone_number"),rules:[{type:"regexp",pattern:new RegExp(/^[0-9]*$/gm)},{required:!0,message:"Noto'g'ri format"}],children:(0,I.jsx)(v.Z,{style:{width:"100%"},placeholder:"Telefon raqamini kiriting"})}),(0,I.jsx)(Z.Z.Item,{name:"role",label:a("usersMenu.role"),rules:[{required:!0,message:"Rolini tanlang"}],children:(0,I.jsx)(f.Z,{allowClear:!0,placeholder:"Rolini tanlang",children:O})}),(0,I.jsx)(Z.Z.Item,{name:"birthday",label:a("usersMenu.birthday"),rules:[{required:!0,message:"Tug'ilgan sanasini kiriting"}],children:(0,I.jsx)(j.Z,{allowClear:!0,showNow:!0,format:T,style:{width:"100%"},disabledDate:C,placeholder:"Sanani kiriting"})})]}))}))})},P=function(){var e,n,a,m,f,Z=(0,h.$)().t,x=(0,k.v9)((function(e){return e.usersSlice})),y=x.openModal,v=x.modalType,j=(0,k.I0)(),b=(0,t.useState)({page:1,pageSize:20}),M=(0,i.Z)(b,2),C=M[0],z=M[1],S=(0,g.xY)(C),D=(0,g.C5)(),P=(0,i.Z)(D,2),R=P[0],X=P[1].isLoading,Y=(0,t.useState)(),O=(0,i.Z)(Y,2),L=O[0],_=O[1],E=[{title:"\u2116",dataIndex:"id",key:"id",width:"5%",render:function(e,n,a){return(0,I.jsx)("span",{children:a+1})}},{title:Z("usersMenu.username"),dataIndex:"username",key:"username"},{title:Z("usersMenu.phone_number"),dataIndex:"phone",key:"phone",render:function(e,n){return(0,I.jsx)(I.Fragment,{children:e})}},{title:Z("usersMenu.role"),dataIndex:"role",key:"role",render:function(e,n){return(0,I.jsx)(I.Fragment,{children:e})}},{title:Z("usersMenu.birthday"),dataIndex:"birthday",key:"birthday",render:function(e,n){return(0,I.jsx)(I.Fragment,{children:w()(e).format(T)})}},{title:Z("actions"),key:"action",width:"20%",render:function(e,n,a){return(0,I.jsxs)(l.Z,{wrap:!1,gutter:5,children:[(0,I.jsx)(d.Z,{children:(0,I.jsx)(s.Z,{size:"small",type:"primary",ghost:!0,onClick:function(){return _(e),void j((0,F.de)({openModal:!0,modalType:"update"}))},children:Z("edit")})}),(0,I.jsx)(d.Z,{children:(0,I.jsx)(u.Z,{okText:Z("yes"),cancelText:Z("no"),onConfirm:function(){return n=e.id,void R({id:n}).unwrap().then((function(e){200===e.statusCode&&o.ZP.success("Muvaffaqiyati o'chirildi.")})).catch((function(e){o.ZP.error("Xatolik yuz berdi. Xatolik: ".concat(e.message))}));var n},title:Z("sureDelete"),children:(0,I.jsx)(s.Z,{size:"small",danger:!0,disabled:X,children:Z("delete")})})})]})}}],N={title:Z("update"===v?"edit":"add"),open:y,okText:Z("update"===v?"edit":"add"),cancelText:Z("close"),onCancel:function(){j((0,F.de)({openModal:!1,modalType:""})),_(void 0)}},U={total:(null===(e=S.data)||void 0===e||null===(n=e.meta)||void 0===n?void 0:n.total)*(null===(a=S.data)||void 0===a||null===(m=a.meta)||void 0===m?void 0:m.pagesize),page:C.page,pageSizeOptions:["20","50","100"],showQuickJumper:!0,showSizeChanger:!0,pageSize:C.pageSize,current:C.page,onChange:function(e,n){z({page:e,pageSize:n})}};return(0,I.jsxs)(I.Fragment,{children:[(0,I.jsxs)(l.Z,{children:[(0,I.jsx)(d.Z,{span:20,children:(0,I.jsx)(c.Z.Title,{level:2,children:Z("menus.users")})}),(0,I.jsx)(d.Z,{span:4,children:(0,I.jsx)(s.Z,{type:"primary",onClick:function(){return j((0,F.de)({openModal:!0,modalType:"create"}))},children:Z("add")})})]}),(0,I.jsx)(p.Z,{columns:E,dataSource:null===(f=S.data)||void 0===f?void 0:f.data,loading:S.isFetching,pagination:U,rowKey:function(e){return e.id}}),(0,I.jsx)(q,(0,r.Z)({updateData:L,t:Z,modalType:v},N))]})}}}]);
//# sourceMappingURL=430.1a8d847a.chunk.js.map